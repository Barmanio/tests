{% extends "base.html" %}

{% block title %}‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É{% endblock %}

{% block content %}
<h1>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É</h1>

{% if error %}
<div style="color: #e74c3c; background: #fadbd8; padding: 12px; border-radius: 6px; margin-bottom: 16px;">
 <strong>‚ùå –û—à–∏–±–∫–∞:</strong> {{ error }}
</div>
{% endif %}

<form method="post" action="/update-task">
 <input type="hidden" name="task_id" value="{{ task.id }}">

 <div style="margin-bottom: 16px;">
 <label for="title" style="display: block; margin-bottom: 6px; font-weight: 500;">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
 <input
 type="text"
 id="title"
 name="title"
 value="{{ task.title }}"
 required
 maxlength="100"
 style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 15px; box-sizing: border-box;">
 </div>

 <div style="margin-bottom: 16px;">
 <label for="description" style="display: block; margin-bottom: 6px; font-weight: 500;">–û–ø–∏—Å–∞–Ω–∏–µ</label>
 <textarea
 id="description"
 name="description"
 required
 maxlength="1000"
 style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 15px; box-sizing: border-box; min-height: 120px; resize: vertical;">{{ task.description }}</textarea>
 </div>

 <h2>üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã</h2>
 <div id="tests-container">
 {% for test in tests %}
 <div class="test-group" style="background: #f8f9fa; padding: 16px; border: 1px solid #e9ecef; border-radius: 6px; margin-bottom: 12px; position: relative;">
 <button type="button" class="remove-test" onclick="removeTest(this)" style="position: absolute; top: 8px; right: 8px; background: #e74c3c; color: white; border: none; width: 24px; height: 24px; border-radius: 50%; font-size: 14px; cursor: pointer;">√ó</button>

 <div style="margin-bottom: 12px;">
 <label>–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</label>
 <textarea
 name="input_data"
 required
 style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; box-sizing: border-box; font-family: monospace; resize: vertical; min-height: 60px;">{{ test.input }}</textarea>
 </div>

 <div style="margin-bottom: 12px;">
 <label>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</label>
 <textarea
 name="expected_output"
 required
 style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; box-sizing: border-box; font-family: monospace; resize: vertical; min-height: 60px;">{{ test.expected_output }}</textarea>
 </div>
 </div>
 {% endfor %}
 </div>

 <button
 type="button"
 onclick="addTest()"
 style="background: #3498db; color: white; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; margin-bottom: 16px;">
 + –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç
 </button>

 <div style="text-align: center;">
 <button
 type="submit"
 style="background: #27ae60; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 16px; cursor: pointer;">
 üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É
 </button>
 </div>
</form>

<a href="/tasks/{{ task.id }}" style="display: block; text-align: center; margin-top: 20px; color: #3498db; text-decoration: none;">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∑–∞–¥–∞—á–µ</a>

<script>
function addTest() {
 const container = document.getElementById('tests-container');
 const group = document.createElement('div');
 group.className = 'test-group';
 group.style = 'background: #f8f9fa; padding: 16px; border: 1px solid #e9ecef; border-radius: 6px; margin-bottom: 12px; position: relative;';

 group.innerHTML = `
 <button type="button" class="remove-test" onclick="removeTest(this)" style="position: absolute; top: 8px; right: 8px; background: #e74c3c; color: white; border: none; width: 24px; height: 24px; border-radius: 50%; font-size: 14px; cursor: pointer;">√ó</button>

 <div style="margin-bottom: 12px;">
 <label>–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</label>
 <textarea name="input_data" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; box-sizing: border-box; font-family: monospace; resize: vertical; min-height: 60px;"></textarea>
 </div>

 <div style="margin-bottom: 12px;">
 <label>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</label>
 <textarea name="expected_output" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; box-sizing: border-box; font-family: monospace; resize: vertical; min-height: 60px;"></textarea>
 </div>
 `;
 container.appendChild(group);
}

function removeTest(button) {
 const group = button.closest('.test-group');
 if (document.querySelectorAll('.test-group').length > 1) {
 group.remove();
 }
}
</script>

<style>
 .remove-test:hover { background: #c0392b; }
</style>
{% endblock %}
